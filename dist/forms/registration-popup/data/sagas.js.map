{"version":3,"file":"sagas.js","names":["camelCaseObject","logError","logInfo","call","put","takeEvery","fetchRealtimeValidations","fetchRealtimeValidationsFailed","fetchRealtimeValidationsSuccess","registerUser","registerUserFailed","registerUserSuccess","registerRequest","getFieldsValidations","INTERNAL_SERVER_ERROR","handleNewUserRegistration","action","authenticatedUser","redirectUrl","success","payload","e","statusCodes","response","includes","status","data","errorCode","fetchValidationsSaga","fieldValidations","saga","type"],"sources":["../../../../src/forms/registration-popup/data/sagas.js"],"sourcesContent":["import { camelCaseObject } from '@edx/frontend-platform';\nimport { logError, logInfo } from '@edx/frontend-platform/logging';\nimport { call, put, takeEvery } from 'redux-saga/effects';\n\nimport {\n  fetchRealtimeValidations, fetchRealtimeValidationsFailed, fetchRealtimeValidationsSuccess,\n  registerUser, registerUserFailed, registerUserSuccess,\n} from './reducers';\nimport registerRequest, { getFieldsValidations } from './service';\nimport { INTERNAL_SERVER_ERROR } from '../../../data/constants';\n\n/**\n * Saga function for handling new user registration.\n * @param {object} action - The Redux action object containing the payload.\n */\nexport function* handleNewUserRegistration(action) {\n  try {\n    const {\n      authenticatedUser, redirectUrl, success,\n    } = yield call(registerRequest, action.payload);\n\n    yield put(registerUserSuccess({\n      authenticatedUser: camelCaseObject(authenticatedUser),\n      redirectUrl,\n      success,\n    }));\n  } catch (e) {\n    const statusCodes = [400, 403, 409];\n    if (e.response && statusCodes.includes(e.response.status)) {\n      yield put(registerUserFailed(camelCaseObject(e.response.data)));\n      logInfo(e);\n    } else {\n      yield put(registerUserFailed({ errorCode: INTERNAL_SERVER_ERROR }));\n      logError(e);\n    }\n  }\n}\n\n/**\n * Saga function for handling new validations.\n * @param {object} action - The Redux action object containing the payload.\n */\nexport function* fetchValidationsSaga(action) {\n  try {\n    const { fieldValidations } = yield call(getFieldsValidations, action.payload);\n\n    yield put(fetchRealtimeValidationsSuccess(camelCaseObject(fieldValidations)));\n  } catch (e) {\n    if (e.response && e.response.status === 403) {\n      yield put(fetchRealtimeValidationsFailed());\n      logInfo(e);\n    } else {\n      logError(e);\n    }\n  }\n}\n\n/**\n * Root Saga function that listens for REGISTER actions and calls the handleNewUserRegistration saga\n * and fetchValidationsSaga.\n */\nexport default function* saga() {\n  yield takeEvery(registerUser.type, handleNewUserRegistration);\n  yield takeEvery(fetchRealtimeValidations.type, fetchValidationsSaga);\n}\n"],"mappings":"AAAA,SAASA,eAAe,QAAQ,wBAAwB;AACxD,SAASC,QAAQ,EAAEC,OAAO,QAAQ,gCAAgC;AAClE,SAASC,IAAI,EAAEC,GAAG,EAAEC,SAAS,QAAQ,oBAAoB;AAEzD,SACEC,wBAAwB,EAAEC,8BAA8B,EAAEC,+BAA+B,EACzFC,YAAY,EAAEC,kBAAkB,EAAEC,mBAAmB,QAChD,YAAY;AACnB,OAAOC,eAAe,IAAIC,oBAAoB,QAAQ,WAAW;AACjE,SAASC,qBAAqB,QAAQ,yBAAyB;;AAE/D;AACA;AACA;AACA;AACA,OAAO,UAAUC,yBAAyBA,CAACC,MAAM,EAAE;EACjD,IAAI;IACF,MAAM;MACJC,iBAAiB;MAAEC,WAAW;MAAEC;IAClC,CAAC,GAAG,MAAMhB,IAAI,CAACS,eAAe,EAAEI,MAAM,CAACI,OAAO,CAAC;IAE/C,MAAMhB,GAAG,CAACO,mBAAmB,CAAC;MAC5BM,iBAAiB,EAAEjB,eAAe,CAACiB,iBAAiB,CAAC;MACrDC,WAAW;MACXC;IACF,CAAC,CAAC,CAAC;EACL,CAAC,CAAC,OAAOE,CAAC,EAAE;IACV,MAAMC,WAAW,GAAG,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,CAAC;IACnC,IAAID,CAAC,CAACE,QAAQ,IAAID,WAAW,CAACE,QAAQ,CAACH,CAAC,CAACE,QAAQ,CAACE,MAAM,CAAC,EAAE;MACzD,MAAMrB,GAAG,CAACM,kBAAkB,CAACV,eAAe,CAACqB,CAAC,CAACE,QAAQ,CAACG,IAAI,CAAC,CAAC,CAAC;MAC/DxB,OAAO,CAACmB,CAAC,CAAC;IACZ,CAAC,MAAM;MACL,MAAMjB,GAAG,CAACM,kBAAkB,CAAC;QAAEiB,SAAS,EAAEb;MAAsB,CAAC,CAAC,CAAC;MACnEb,QAAQ,CAACoB,CAAC,CAAC;IACb;EACF;AACF;;AAEA;AACA;AACA;AACA;AACA,OAAO,UAAUO,oBAAoBA,CAACZ,MAAM,EAAE;EAC5C,IAAI;IACF,MAAM;MAAEa;IAAiB,CAAC,GAAG,MAAM1B,IAAI,CAACU,oBAAoB,EAAEG,MAAM,CAACI,OAAO,CAAC;IAE7E,MAAMhB,GAAG,CAACI,+BAA+B,CAACR,eAAe,CAAC6B,gBAAgB,CAAC,CAAC,CAAC;EAC/E,CAAC,CAAC,OAAOR,CAAC,EAAE;IACV,IAAIA,CAAC,CAACE,QAAQ,IAAIF,CAAC,CAACE,QAAQ,CAACE,MAAM,KAAK,GAAG,EAAE;MAC3C,MAAMrB,GAAG,CAACG,8BAA8B,CAAC,CAAC,CAAC;MAC3CL,OAAO,CAACmB,CAAC,CAAC;IACZ,CAAC,MAAM;MACLpB,QAAQ,CAACoB,CAAC,CAAC;IACb;EACF;AACF;;AAEA;AACA;AACA;AACA;AACA,eAAe,UAAUS,IAAIA,CAAA,EAAG;EAC9B,MAAMzB,SAAS,CAACI,YAAY,CAACsB,IAAI,EAAEhB,yBAAyB,CAAC;EAC7D,MAAMV,SAAS,CAACC,wBAAwB,CAACyB,IAAI,EAAEH,oBAAoB,CAAC;AACtE","ignoreList":[]}