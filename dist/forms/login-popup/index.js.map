{"version":3,"file":"index.js","names":["React","useEffect","useMemo","useRef","useState","getConfig","snakeCaseObject","useIntl","Container","Form","StatefulButton","AccountActivationMessage","LoginFailureAlert","NUDGE_PASSWORD_CHANGE","REQUIRE_PASSWORD_CHANGE","useGetActivationMessage","loginUser","setLoginSSOIntent","messages","setCurrentOpenedForm","InlineLink","SocialAuthProviders","COMPLETE_STATE","ENTERPRISE_LOGIN_URL","FAILURE_STATE","FORGOT_PASSWORD_FORM","INVALID_FORM","REGISTRATION_FORM","TPA_AUTHENTICATION_FAILURE","useDispatch","useSelector","getAllPossibleQueryParams","moveScrollToTop","trackForgotPasswordLinkClick","trackLoginPageViewed","trackLoginSuccess","trackRegisterFormToggled","AuthenticatedRedirection","SSOFailureAlert","ThirdPartyAuthAlert","TextField","EmailOrUsernameField","PasswordField","ResetPasswordSuccess","LoginForm","formatMessage","dispatch","queryParams","emailOrUsernameRef","socialAuthnButtonRef","errorAlertRef","loginFormHeadingRef","loginResult","state","login","loginErrorCode","loginError","errorCode","loginErrorContext","errorContext","providers","commonData","thirdPartyAuthContext","thirdPartyAuthApiStatus","submitState","currentProvider","thirdPartyAuthErrorMessage","errorMessage","finishAuthUrl","showResetPasswordSuccessBanner","accountActivation","formFields","setFormFields","emailOrUsername","password","formErrors","setFormErrors","setErrorCode","type","context","length","current","focus","success","localStorage","removeItem","getItem","_objectSpread","prevState","count","setItem","validateFormFields","payload","fieldErrors","usernameOrEmailValidationMessage","usernameOrEmailLessCharValidationMessage","passwordValidationMessage","handleOnChange","event","name","value","target","handleOnFocus","prevErrors","handleForgotPasswordClick","handleSubmit","e","preventDefault","validationErrors","createElement","size","className","redirectUrl","ref","loginFormHeading1","messageType","alertTitle","loginFailureHeaderTitle","Fragment","loginFormHeading2","tabIndex","id","label","autoComplete","handleChange","handleFocus","floatingLabel","loginFormPasswordFieldLabel","showPasswordTooltip","onClick","linkText","loginFormForgotPasswordButton","variant","labels","default","loginFormSignInButton","pending","onMouseDown","linkHelpText","loginFormRegistrationHelpText","loginFormRegistrationLink","destination","LMS_BASE_URL","loginFormSchoolAndOrganizationHelpText","loginFormSchoolAndOrganizationLink"],"sources":["../../../src/forms/login-popup/index.jsx"],"sourcesContent":["import React, {\n  useEffect, useMemo, useRef, useState,\n} from 'react';\n\nimport { getConfig, snakeCaseObject } from '@edx/frontend-platform';\nimport { useIntl } from '@edx/frontend-platform/i18n';\nimport {\n  Container, Form, StatefulButton,\n} from '@openedx/paragon';\n\nimport AccountActivationMessage from './components/AccountActivationMessage';\nimport LoginFailureAlert from './components/LoginFailureAlert';\nimport { NUDGE_PASSWORD_CHANGE, REQUIRE_PASSWORD_CHANGE } from './data/constants';\nimport useGetActivationMessage from './data/hooks';\nimport { loginUser, setLoginSSOIntent } from './data/reducers';\nimport messages from './messages';\nimport { setCurrentOpenedForm } from '../../authn-component/data/reducers';\nimport { InlineLink, SocialAuthProviders } from '../../common-ui';\nimport {\n  COMPLETE_STATE,\n  ENTERPRISE_LOGIN_URL,\n  FAILURE_STATE,\n  FORGOT_PASSWORD_FORM,\n  INVALID_FORM,\n  REGISTRATION_FORM,\n  TPA_AUTHENTICATION_FAILURE,\n} from '../../data/constants';\nimport { useDispatch, useSelector } from '../../data/storeHooks';\nimport getAllPossibleQueryParams, { moveScrollToTop } from '../../data/utils';\nimport {\n  trackForgotPasswordLinkClick, trackLoginPageViewed, trackLoginSuccess, trackRegisterFormToggled,\n} from '../../tracking/trackers/login';\nimport AuthenticatedRedirection from '../common-components/AuthenticatedRedirection';\nimport SSOFailureAlert from '../common-components/SSOFailureAlert';\nimport ThirdPartyAuthAlert from '../common-components/ThirdPartyAuthAlert';\nimport {\n  TextField as EmailOrUsernameField,\n  PasswordField,\n} from '../fields';\nimport ResetPasswordSuccess from '../reset-password-popup/reset-password/components/ResetPasswordSuccess';\n\nimport './index.scss';\n\n/**\n * Login form component that holds the login form functionality.\n *\n * @returns {JSX.Element} The rendered login component along with social auth buttons.\n */\nconst LoginForm = () => {\n  const { formatMessage } = useIntl();\n  const dispatch = useDispatch();\n  const queryParams = useMemo(() => getAllPossibleQueryParams(), []);\n\n  const emailOrUsernameRef = useRef(null);\n  const socialAuthnButtonRef = useRef(null);\n  const errorAlertRef = useRef(null);\n  const loginFormHeadingRef = useRef(null);\n\n  const loginResult = useSelector(state => state.login.loginResult);\n  const loginErrorCode = useSelector(state => state.login.loginError?.errorCode);\n  const loginErrorContext = useSelector(state => state.login.loginError?.errorContext);\n  const providers = useSelector(state => state.commonData.thirdPartyAuthContext?.providers);\n  const thirdPartyAuthApiStatus = useSelector(state => state.commonData.thirdPartyAuthApiStatus);\n  const submitState = useSelector(state => state.login.submitState);\n  const currentProvider = useSelector(state => state.commonData.thirdPartyAuthContext.currentProvider);\n  const thirdPartyAuthErrorMessage = useSelector(state => state.commonData.thirdPartyAuthContext.errorMessage);\n  const finishAuthUrl = useSelector(state => state.commonData.thirdPartyAuthContext.finishAuthUrl);\n  const showResetPasswordSuccessBanner = useSelector(state => state.login.showResetPasswordSuccessBanner);\n\n  const accountActivation = useGetActivationMessage();\n\n  const [formFields, setFormFields] = useState({\n    emailOrUsername: '',\n    password: '',\n  });\n\n  const [formErrors, setFormErrors] = useState({\n    emailOrUsername: '',\n    password: '',\n  });\n  const [errorCode, setErrorCode] = useState({ type: '', context: {} });\n\n  useEffect(() => {\n    trackLoginPageViewed();\n  }, []);\n\n  useEffect(() => {\n    if (thirdPartyAuthApiStatus === COMPLETE_STATE && accountActivation === null) {\n      if (providers.length > 0 && socialAuthnButtonRef.current) {\n        socialAuthnButtonRef.current.focus();\n      } else if (emailOrUsernameRef.current) {\n        emailOrUsernameRef.current.focus();\n      }\n    } else if (thirdPartyAuthApiStatus === FAILURE_STATE && accountActivation === null) {\n      emailOrUsernameRef.current.focus();\n    }\n  }, [accountActivation, thirdPartyAuthApiStatus, providers]);\n\n  useEffect(() => {\n    if (moveScrollToTop) {\n      moveScrollToTop(loginFormHeadingRef, 'end');\n    }\n  }, []);\n\n  useEffect(() => {\n    if (loginResult.success) {\n      // clear local storage\n      trackLoginSuccess();\n      localStorage.removeItem('ssoPipelineRedirectionDone');\n    }\n  }, [loginResult]);\n\n  useEffect(() => {\n    if (thirdPartyAuthApiStatus === COMPLETE_STATE\n      && currentProvider === null\n      && localStorage.getItem('ssoPipelineRedirectionDone')\n    ) {\n      localStorage.removeItem('ssoPipelineRedirectionDone');\n    }\n  }, [currentProvider, thirdPartyAuthApiStatus]);\n\n  useEffect(() => {\n    if (loginErrorCode) {\n      setErrorCode({\n        type: loginErrorCode,\n        context: { ...loginErrorContext },\n      });\n      if (loginErrorCode === NUDGE_PASSWORD_CHANGE || loginErrorCode === REQUIRE_PASSWORD_CHANGE) {\n        dispatch(setCurrentOpenedForm(FORGOT_PASSWORD_FORM));\n      }\n      if (errorAlertRef.current) {\n        errorAlertRef.current.focus();\n      }\n    }\n  }, [dispatch, loginErrorCode, loginErrorContext]);\n\n  useEffect(() => {\n    if (thirdPartyAuthErrorMessage) {\n      setErrorCode((prevState) => ({\n        type: TPA_AUTHENTICATION_FAILURE,\n        count: prevState.count + 1,\n        context: {\n          errorMessage: thirdPartyAuthErrorMessage,\n        },\n      }));\n    }\n  }, [thirdPartyAuthErrorMessage]);\n\n  useEffect(() => {\n    if (thirdPartyAuthApiStatus === COMPLETE_STATE && currentProvider) {\n      dispatch(setLoginSSOIntent());\n      if (!localStorage.getItem('ssoPipelineRedirectionDone')) {\n        localStorage.setItem('ssoPipelineRedirectionDone', true);\n      }\n    }\n  }, [dispatch, currentProvider, thirdPartyAuthApiStatus]);\n\n  const validateFormFields = (payload) => {\n    const { emailOrUsername, password } = payload;\n    const fieldErrors = { ...formErrors };\n\n    if (emailOrUsername === '') {\n      fieldErrors.emailOrUsername = formatMessage(messages.usernameOrEmailValidationMessage);\n    } else if (emailOrUsername.length < 2) {\n      fieldErrors.emailOrUsername = formatMessage(messages.usernameOrEmailLessCharValidationMessage);\n    }\n    if (password === '') {\n      fieldErrors.password = formatMessage(messages.passwordValidationMessage);\n    }\n\n    return { ...fieldErrors };\n  };\n\n  const handleOnChange = (event) => {\n    const { name, value } = event.target;\n    setFormFields(prevState => ({ ...prevState, [name]: value }));\n  };\n\n  const handleOnFocus = (event) => {\n    const { name } = event.target;\n    setFormErrors(prevErrors => ({ ...prevErrors, [name]: '' }));\n  };\n\n  const handleForgotPasswordClick = () => {\n    dispatch(setCurrentOpenedForm(FORGOT_PASSWORD_FORM));\n    trackForgotPasswordLinkClick();\n  };\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n\n    const validationErrors = validateFormFields(formFields);\n\n    if (validationErrors.emailOrUsername || validationErrors.password) {\n      setFormErrors({ ...validationErrors });\n      setErrorCode({ type: INVALID_FORM, context: {} });\n      if (moveScrollToTop) {\n        moveScrollToTop(errorAlertRef);\n      }\n      return;\n    }\n\n    // add query params to the payload\n    const payload = {\n      ...snakeCaseObject(formFields),\n      ...queryParams,\n    };\n    dispatch(loginUser(payload));\n  };\n\n  return (\n    <Container size=\"lg\" className=\"authn__popup-container\">\n      <AuthenticatedRedirection\n        success={loginResult.success}\n        redirectUrl={loginResult.redirectUrl}\n        finishAuthUrl={finishAuthUrl}\n      />\n      <h1\n        className=\"display-1 font-italic text-center mb-0\"\n        data-testid=\"sign-in-heading\"\n        ref={loginFormHeadingRef}\n      >\n        {formatMessage(messages.loginFormHeading1)}\n      </h1>\n      <hr className=\"heading-separator my-3 my-sm-4\" />\n      {accountActivation && <AccountActivationMessage messageType={accountActivation} />}\n      <SSOFailureAlert\n        errorCode={errorCode.type}\n        context={errorCode.context}\n        alertTitle={formatMessage(messages.loginFailureHeaderTitle)}\n      />\n      {!currentProvider && (\n        <>\n          <SocialAuthProviders ref={socialAuthnButtonRef} />\n          <div className=\"text-center my-3 my-sm-4\">\n            {formatMessage(messages.loginFormHeading2)}\n          </div>\n        </>\n      )}\n      <div ref={errorAlertRef} tabIndex=\"-1\" aria-live=\"assertive\">\n        <LoginFailureAlert\n          errorCode={errorCode.type}\n          context={errorCode.context}\n        />\n      </div>\n      {showResetPasswordSuccessBanner && <ResetPasswordSuccess />}\n      <ThirdPartyAuthAlert\n        currentProvider={currentProvider}\n      />\n      <Form id=\"login-form\" name=\"login-form\" className=\"my-3 my-sm-4\">\n        <EmailOrUsernameField\n          label=\"Username or email\"\n          name=\"emailOrUsername\"\n          autoComplete=\"username\"\n          value={formFields.emailOrUsername}\n          errorMessage={formErrors.emailOrUsername}\n          handleChange={handleOnChange}\n          handleFocus={handleOnFocus}\n          ref={emailOrUsernameRef}\n        />\n        <PasswordField\n          name=\"password\"\n          value={formFields.password}\n          errorMessage={formErrors.password}\n          handleChange={handleOnChange}\n          handleFocus={handleOnFocus}\n          floatingLabel={formatMessage(messages.loginFormPasswordFieldLabel)}\n          showPasswordTooltip={false}\n        />\n        <InlineLink\n          className=\"hyper-link mb-4\"\n          onClick={handleForgotPasswordClick}\n          linkText={formatMessage(messages.loginFormForgotPasswordButton)}\n        />\n        <div className=\"d-flex flex-column m-0\">\n          <StatefulButton\n            id=\"login-user\"\n            name=\"login-user\"\n            type=\"submit\"\n            variant=\"primary\"\n            className=\"align-self-end login__btn-width authn-btn__pill-shaped\"\n            state={submitState}\n            labels={{\n              default: formatMessage(messages.loginFormSignInButton),\n              pending: '',\n            }}\n            onClick={handleSubmit}\n            onMouseDown={(e) => e.preventDefault()}\n          />\n        </div>\n      </Form>\n      <div>\n        <InlineLink\n          className=\"mb-2\"\n          onClick={() => {\n            trackRegisterFormToggled();\n            dispatch(setCurrentOpenedForm(REGISTRATION_FORM));\n          }}\n          linkHelpText={formatMessage(messages.loginFormRegistrationHelpText)}\n          linkText={formatMessage(messages.loginFormRegistrationLink)}\n        />\n        <InlineLink\n          destination={getConfig().LMS_BASE_URL + ENTERPRISE_LOGIN_URL}\n          linkHelpText={formatMessage(messages.loginFormSchoolAndOrganizationHelpText)}\n          linkText={formatMessage(messages.loginFormSchoolAndOrganizationLink)}\n        />\n      </div>\n    </Container>\n  );\n};\n\nexport default LoginForm;\n"],"mappings":"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","ignoreList":[]}