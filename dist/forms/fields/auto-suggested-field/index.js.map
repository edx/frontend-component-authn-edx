{"version":3,"file":"index.js","names":["React","useEffect","useState","useIntl","FormAutosuggest","FormAutosuggestOption","FormControlFeedback","FormLabel","classNames","PropTypes","messages","AutoSuggestField","props","name","label","placeholder","feedBack","errorMessage","options","selectedOption","value","displayText","leadingElement","onChangeHandler","onFocusHandler","onBlurHandler","formatMessage","setValue","country","_objectSpread","userProvidedText","selectionValue","selectionId","handleOnChange","e","fieldName","target","text","getFieldOptions","fieldOptions","map","option","createElement","id","code","key","className","onChange","onFocus","onBlur","hasIcon","type","propTypes","string","isRequired","arrayOf","shape","node","func"],"sources":["../../../../src/forms/fields/auto-suggested-field/index.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\n\nimport { useIntl } from '@edx/frontend-platform/i18n';\nimport {\n  FormAutosuggest,\n  FormAutosuggestOption,\n  FormControlFeedback,\n  FormLabel,\n} from '@openedx/paragon';\nimport classNames from 'classnames';\nimport PropTypes from 'prop-types';\n\nimport messages from '../../progressive-profiling-popup/messages';\nimport './index.scss';\n\n/**\n * Auto Suggest field wrapper. It accepts following handlers\n * - handleChange for setting value on change\n * - onFocusHandler for clearing error state\n * - onBlurHandler for setting error on null value\n *\n * It is responsible for\n * - Auto populating progressive profiling fields\n * - setting value on change and selection\n */\nconst AutoSuggestField = (props) => {\n  const {\n    name,\n    label = '',\n    placeholder,\n    feedBack = '',\n    errorMessage = '',\n    options,\n    selectedOption = {\n      value: '',\n      displayText: '',\n    },\n    leadingElement = '',\n    onChangeHandler,\n    onFocusHandler = () => {},\n    onBlurHandler = () => {},\n  } = props;\n  const { formatMessage } = useIntl();\n  const [value, setValue] = useState({});\n\n  useEffect(() => {\n    if (name === 'country'\n      && selectedOption.value !== ''\n      && !value.country\n    ) {\n      setValue({\n        ...value,\n        [name]: {\n          userProvidedText: selectedOption?.displayText,\n          selectionValue: selectedOption?.value,\n          selectionId: selectedOption?.value,\n        },\n      });\n    }\n  }, [name, selectedOption, value]);\n\n  const handleOnChange = (e, fieldName) => {\n    setValue({\n      ...value,\n      [fieldName]: e,\n    });\n    onChangeHandler({ target: { name, value: e.selectionId, text: e.userProvidedText } });\n  };\n\n  const getFieldOptions = (fieldName, fieldOptions) => fieldOptions.map(option => {\n    if (fieldName === 'country') {\n      return (\n        <FormAutosuggestOption id={option.code} key={option.code}>{option.name}</FormAutosuggestOption>\n      );\n    }\n    return (\n      <FormAutosuggestOption id={option.label} key={option.label}>\n        {\n          messages[`${fieldName}.option.${option.label}`]\n            ? formatMessage(messages[`${fieldName}.option.${option.label}`])\n            : option.label\n        }\n      </FormAutosuggestOption>\n    );\n  });\n\n  return (\n    <div className=\"mb-4\">\n      {name !== 'country' && <FormLabel>{label}</FormLabel>}\n      <FormAutosuggest\n        placeholder={placeholder}\n        aria-label=\"form autosuggest\"\n        name={name}\n        value={value[name] || {}}\n        leadingElement={leadingElement}\n        className={classNames({ 'form-field-error': errorMessage })}\n        onChange={(e) => { handleOnChange(e, name); }}\n        onFocus={() => { onFocusHandler({ target: { name, value: '' } }); }}\n        onBlur={() => { onBlurHandler({ target: { name, value: value[name] ? value[name].selectionId : '' } }); }}\n      >\n        {getFieldOptions(name, options)}\n      </FormAutosuggest>\n      {(errorMessage !== '' || feedBack !== '') && (\n        <FormControlFeedback\n          key={errorMessage ? 'error' : 'feedback'}\n          hasIcon={false}\n          feedback-for={name}\n          type={errorMessage ? 'invalid' : 'valid'}\n        >\n          {errorMessage || feedBack}\n        </FormControlFeedback>\n      )}\n    </div>\n  );\n};\n\nAutoSuggestField.propTypes = {\n  name: PropTypes.string.isRequired,\n  label: PropTypes.string,\n  placeholder: PropTypes.string.isRequired,\n  options: PropTypes.arrayOf(\n    PropTypes.shape({\n      code: PropTypes.string,\n      displayText: PropTypes.string,\n    }),\n  ).isRequired,\n  errorMessage: PropTypes.string,\n  feedBack: PropTypes.string,\n  leadingElement: PropTypes.node,\n  onChangeHandler: PropTypes.func.isRequired,\n  onFocusHandler: PropTypes.func,\n  onBlurHandler: PropTypes.func,\n  selectedOption: PropTypes.shape({\n    displayText: PropTypes.string,\n    value: PropTypes.string,\n  }),\n};\n\nexport default AutoSuggestField;\n"],"mappings":"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","ignoreList":[]}